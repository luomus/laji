<div class="label-editor-window" #editor>
  <div class="menubar">
    <ul>
      <li [class.active]="_active === 'file'" (click)="_active = 'file'"><a>File</a></li>
      <li [class.active]="_active === 'edit'" (click)="_active = 'edit'"><a>Edit</a></li>
      <li [class.active]="_active === 'view'" (click)="_active = 'view'"><a>View</a></li>
      <li [class.active]="_active === 'fields'" (click)="_active = 'fields'"><a>Label fields</a></li>
      <li [class.active]="_active === 'settings'" (click)="_active = 'settings'"><a>Settings</a></li>
      <li [class.active]="_active === 'help'" (click)="_active = 'help'"><a>Help</a></li>
    </ul>
  </div>
  <div class="window-content">
    <div class="settings-wrap" [class.dragging]="dragging" #settings>
      <div *ngIf="_active === 'view'">
        <ll-view-settings [viewSettings]="_viewSettings" (viewSettingsChange)="viewSettingsChange.emit($event)"></ll-view-settings>
      </div>
      <div *ngIf="_active === 'help'">
        <h3 class="first">TODO: help content and videos</h3>
      </div>
      <div *ngIf="_active === 'file'">
        <ll-label-file [setup]="_setup" (setupChange)="setupChanged($event)" [data]="data" (html)="html.emit($event)"></ll-label-file>
      </div>
      <div [hidden]="_active !== 'edit'">
        <div class="undo-button link" [class.disabled]="!hasUndo()" (click)="undo()">
          <svg width="14" height="14" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg>
          Undo
        </div>
        <div class="redo-button link" [class.disabled]="!hasRedo()" (click)="redo()">
          <svg width="14" height="14" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/></svg>
          Redo
        </div>
        <h3>Generate data</h3>
        <table>
          <tr><td>Uri:</td><td><input (change)="updateGenerate('uri', $event.target.value)" type="text" class="form-control input-sm"></td></tr>
          <tr><td>Range start:</td><td><input (change)="updateGenerate('rangeStart', $event.target.value)" type="text" class="form-control input-sm"></td></tr>
          <tr><td>Range end:</td><td><input (change)="updateGenerate('rangeEnd', $event.target.value)" type="text" class="form-control input-sm"></td></tr>
          <tr *ngIf="fields.length > 0"><td colspan="2">&nbsp;</td></tr>
          <tr *ngFor="let field of fields;">
            <td>{{field.label}}:</td><td><input [value]="generate.data[field.field] ||Â ''" (change)="updateGenerate(field.field, $event.target.value, true)" type="text" class="form-control input-sm"></td>
          </tr>
        </table>
        <div style="margin-top: 15px;">
          <button (click)="generateData()" style="margin-top: 5px;" class="btn btn-default btn-sm pull-right">Generate</button>
        </div>
      </div>
      <div [hidden]="_active !== 'settings'">
        <ll-label-settings
          [setup]="_setup"
          (setupChange)="setupChanged($event)"
          [selectedLabelItem]="_selectedLabelItem"
          [availableFields]="availableFields"
        ></ll-label-settings>
      </div>
      <div [hidden]="_active !== 'fields'">
        <ll-label-fields-available
          (dragging)="newFieldDragging($event, settings)"
          [magnification]="_viewSettings.magnification"
          [availableFields]="availableFields"
          (addLabelItem)="addLabelItem($event)"
        ></ll-label-fields-available>
      </div>
    </div>
    <div class="editor-wrap">
      <div class="editor-space">
        <ll-label-editor
          [active]="_selectedLabelItem"
          (activeChange)="setActiveLabelItem($event)"
          (done)="done()"
          [setup]="_setup"
          (setupChange)="setupChanged($event)"
          [grid]="_viewSettings.grid"
          [gridVisible]="_viewSettings.gridVisible"
          [magnification]="_viewSettings.magnification"
          (showSettings)="showSettings($event)"></ll-label-editor>
        <div *ngIf="_setup.twoSided" style="margin-top: 10px; display: inline-block;">
          <ll-label-editor
            [backSide]="true"
            [active]="_selectedLabelItem"
            (activeChange)="setActiveLabelItem($event)"
            (done)="done()"
            [setup]="_setup"
            (setupChange)="setupChanged($event)"
            [grid]="_viewSettings.grid"
            [gridVisible]="_viewSettings.gridVisible"
            [magnification]="_viewSettings.magnification"
            (showSettings)="showSettings($event)"></ll-label-editor>
        </div>
      </div>
      <div class="preview-space">
        <strong>Preview</strong>
        <div style="margin-bottom: 5px;">
          <div style="margin: 5px 15px 0 0; border: 1px solid #999; display: inline-block">
            <ll-label-preview [setup]="_setup"></ll-label-preview>
          </div>
          <div *ngIf="_setup.twoSided" style="margin-top: 5px; border: 1px solid #999; display: inline-block">
            <ll-label-preview [setup]="_setup" [backSide]="true"></ll-label-preview>
          </div>
        </div>
        <small *ngIf="dimensions">
          There can be a total of {{dimensions.cols * dimensions.rows}} labels on a single page (in {{dimensions.cols}} columns and {{dimensions.rows}} rows).
        </small>
      </div>
    </div>
  </div>
</div>
<ll-info-window></ll-info-window>
<ng-template #intro>
  <div style="text-align: center; margin: 0 0 20px 0">
    <ll-icon [type]="'logo'" [size]="72"></ll-icon>
    <div style="margin-top: -5px">
      <small>Version {{version}}</small>
    </div>
  </div>

  <p>With this tool you can make a specimen label design that can be used to print labels for Notebook observations.</p>
  <p>You can start from scratch and design an entirely new label. You can also use pre-defined label templates as they are or as a starting point for your design.</p>
  <p>
    Under Fields you find all the data fields available for labels.
    Under settings you can adjust both general label settings and separate field settings.
    Under Files you can save your label desing templates, load previously saved templates,
    see your recent label template files and download the label pdf.
  </p>
</ng-template>
