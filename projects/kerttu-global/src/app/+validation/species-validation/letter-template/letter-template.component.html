<h3>{{ 'validation.templates.audio' | translate }}</h3>
<p>{{ 'validation.templates.audio.description' | translate }}</p>
<div class="audio-viewer-with-settings">
  <laji-audio-viewer-settings
    [(zoomed)]="zoomFrequency"
    [(xRangePadding)]="timePadding"
    [defaultZoomed]="defaultZoomFrequency"
    [defaultXRangePadding]="defaultTimePadding"
    [displayInline]="true"
  ></laji-audio-viewer-settings>
  <laji-audio-viewer
    [audio]="audio"
    [spectrogramConfig]="spectrogramConfig"
    [mode]="audioViewerMode"
    [focusArea]="template ? template.area : {'xRange': [focusTime, focusTime]}"
    [spectrogramHeight]="150"
    [showZoomControl]="true"
    [zoomFrequency]="template ? zoomFrequency : false"
    [zoomTime]="true"
    [timePaddingOnZoom]="template ? timePadding : 60"
    (drawEnd)="onDrawEnd($event)"
  ></laji-audio-viewer>
</div>
<div class="mt-3 clearfix">
  <div class="pull-right">
    <button
      class="btn btn-primary"
      [ngClass]="{'active': audioViewerMode === 'draw'}"
      (click)="toggleDrawMode()"
    >
      {{ ('validation.templates.' + (template ? 'reframe' : 'frame')) | translate }}
    </button>
  </div>
</div>

<div class="row mt-5">
  <div class="col-sm-4">
    <h3 class="d-inline-block">{{ ('validation.templates.' + (isNew ? 'new' : 'current')) | translate }} T{{ templateIdx + 1 }}</h3>
    <p>{{ 'validation.templates.template.description' | translate }}</p>
  </div>
  <div class="col-sm-8">
    <laji-audio-viewer
      *ngIf="template"
      [audio]="audio"
      [spectrogramConfig]="spectrogramConfig"
      [focusArea]="template.area"
      [zoomTime]="true"
      [timePaddingOnZoom]="0.5"
      [zoomFrequency]="true"
      [showControls]="false"
      [spectrogramHeight]="150"
      [showAxisLabels]="false"
      [mode]="audioViewerMode"
      (drawEnd)="onDrawEnd($event)"
    ></laji-audio-viewer>
  </div>
</div>
<div class="mt-3 mb-5">
  <div class="pull-right">
    <button
      [disabled]="!template"
      class="btn btn-success mr-3"
      (click)="confirm.emit(template)"
    >
      {{ 'validation.templates.confirm' | translate }}
    </button>
    <button
      class="btn btn-default mr-3"
      (click)="cancel.emit()"
    >
      {{ 'validation.templates.cancel' | translate }}
    </button>
    <button
      [disabled]="!template || isNew"
      class="btn btn-danger"
      (click)="remove.emit()"
    >
      {{ 'validation.templates.remove' | translate }}
    </button>
  </div>
</div>