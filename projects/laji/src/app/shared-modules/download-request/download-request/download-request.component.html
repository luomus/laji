@if (downloadRequest) {
  @if (showTitle) {
    <h3>{{ 'downloadRequest.' + downloadRequestType | translate }} {{ downloadRequest.id | toFullUri }}</h3>
  }
  <laji-download-request-basic-info
    [downloadRequest]="downloadRequest"
    [showPerson]="showPerson"
    [downloadRequestType]="downloadRequestType"
  ></laji-download-request-basic-info>
  @if (showDownload === 'always' || (showDownload === 'publicOnly' && downloadRequest.publicDownload)) {
    @if (downloadRequestType === 'fileDownload') {
      <h4>{{ 'downloadRequest.download' | translate }}</h4>
      @if (showDownload === 'publicOnly' && downloadRequest.publicDownload) {
        <div
          role="alert"
          class="alert alert-success"
          [innerHTML]="'downloadRequest.fileDownload.licenseReminder' | translate"
        ></div>
      }
      <laji-file-download [downloadRequest]="downloadRequest"></laji-file-download>
      <div class="mt-4" [innerHTML]="'downloadRequest.fileDownload.instructionLinks' | translate"></div>
    } @else {
      <h4>{{ 'downloadRequest.copyApiKey' | translate }}</h4>
      <laji-copy-to-clipboard [value]="downloadRequest.apiKey ?? ''" [wrapText]="true"></laji-copy-to-clipboard>
    }
  }
  @if (showDownload === 'publicOnly') {
    @if (downloadRequest.publicDownload) {
      <h4>{{ 'downloadRequest.citation' | translate }}</h4>
      <p>{{ 'downloadRequest.youMayCite' | translate }}</p>
      <input class="form-control" type="text" readonly="readonly" [value]="(
        'downloadRequest.citationFinBIF' | translate) + '. ' + (downloadRequest.id | toFullUri) + ' (' +
        ('downloadRequest.accessed' | translate) + ' ' + (downloadRequest.requested | amDateFormat:'D.M.YYYY') +
        ').'"
        (focus)="selectInput($event)"
        (click)="selectInput($event)"
        >
        @if (downloadRequest.collections) {
          <p>{{ 'downloadRequest.partialCitation' | translate }}</p>
        <input class="form-control" type="text" readonly="readonly" [value]="(
          'downloadRequest.citationFinBIF' | translate) + '. ' + (downloadRequest.id | toFullUri) + ', ' +
          (downloadRequest.collections | pluck:'id' | toFullUri | values) + ' (' +
          ('downloadRequest.accessed' | translate) + ' ' + (downloadRequest.requested | amDateFormat:'D.M.YYYY') +
          ').'"
            (focus)="selectInput($event)"
            (click)="selectInput($event)"
            >
          }
          <p>{{ 'downloadRequest.rowCitation' | translate }}</p>
      <input class="form-control" type="text" readonly="readonly" [value]="(
        'downloadRequest.citationFinBIF' | translate) + '. http://tun.fi/EXMP.1234, http://some.org/9876 (' +
        ('downloadRequest.accessed' | translate) + ' ' + (downloadRequest.requested | amDateFormat:'D.M.YYYY') +
        ').'"
            (focus)="selectInput($event)"
            (click)="selectInput($event)"
            >
          } @else {
            @if (downloadRequestType === 'fileDownload') {
              <h4>
                {{ 'downloadRequest.downloadNotAllowedReason.' + (
                downloadRequest.downloadType === 'APPROVED_DATA_REQUEST' ? 'pyha' : (
                downloadRequest.downloadType === 'LIGHTWEIGHT' ? 'lightweight' : 'authorities'
                )) | translate
                }}
              </h4>
            }
          }
        }
        @if (downloadRequest.filterDescriptions) {
          <h4>{{ 'downloadRequest.filters' | translate }}</h4>
          <ul>
            @for (desc of (downloadRequest.filterDescriptions | multiLang); track desc) {
              <li>
                {{ desc.label }}: {{ desc.value }}
              </li>
            }
          </ul>
        }
        @if (downloadRequest.publicLink || downloadRequest.privateLink) {
          {{ 'downloadRequest.link' | translate }}:
          <a
            class="wrap-text"
            [href]="(downloadRequest.privateLink ? downloadRequest.privateLink : downloadRequest.publicLink) | multiLang"
            target="_blank"
            >
            {{ (downloadRequest.privateLink ? downloadRequest.privateLink : downloadRequest.publicLink) | multiLang }}
          </a>
        }
        @if (downloadRequest.collections) {
          <h4>{{ 'downloadRequest.collections' | translate }}</h4>
          <laji-collection-table
            [collections]="(collections$ | async) ?? []"
          ></laji-collection-table>
        }
      }
