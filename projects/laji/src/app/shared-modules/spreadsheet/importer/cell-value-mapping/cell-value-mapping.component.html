<div class="cell-value-map-wrap">
  <p>
    {{ 'excel.map.value-intro' | translate }}
  </p>

  @if (field) {
    <h4>{{ field.fullLabel }}</h4>
  }
  @switch (special) {
    @case (specials.person) {
      <laji-special-friend
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
      ></laji-special-friend>
    }
    @case (specials.geometry) {
      <laji-special-geometry
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
        (done)="analyseNextColumn()"
      ></laji-special-geometry>
    }
    @case (specials.taxonID) {
      <laji-special-taxon-id
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
      ></laji-special-taxon-id>
    }
    @case (specials.informalTaxonGroupID) {
      <laji-special-informal-taxon-groups
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
      ></laji-special-informal-taxon-groups>
    }
    @case (specials.unitTaxon) {
      <laji-special-taxon-name
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
      ></laji-special-taxon-name>
    }
    @case (specials.namedPlaceID) {
      <laji-special-named-places
        [formID]="formID"
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
      ></laji-special-named-places>
    }
    @default {
      <laji-cell-value-select
        [field]="field"
        [invalidValues]="invalid"
        [mapping]="valueMap[field.key]"
        (mappingChanged)="onMapping($event)"
      ></laji-cell-value-select>
    }
  }

  <div class="row">
    <div class="col-sm-12">
      <button class="btn btn-primary pull-right next-value-map" [disabled]="!allMapped" (click)="analyseNextColumn()">{{ 'paginator.next' | translate }}</button>
    </div>
  </div>
</div>
