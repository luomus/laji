<div [ngStyle]="{'width': staticWidth ? (staticWidth - 50) +'px': undefined}" class="fixedDimension">

  @if (unsaved) {
    <div class="unsaved" [luTooltip]="'haseka.users.unsaved.doc' | translate" [placement]="'left'">
      <div>!</div>
    </div>
  }

  <header>
    @if (locality) {
      <h1>{{ locality }}</h1>
    }
    @if (document.publicityRestrictions === publicity.publicityRestrictionsPrivate) {
      <div class="label label-warning">
        {{ 'result.latestObservationsLabel' | translate }}
      </div>
    }
    @if (showFormName) {
      <div class="label label-default form-name">{{ document.formID | formName }}</div>
    }
  </header>

  <section>
    @if (!changingLocale && document.dateEdited) {
      <div class="observation-last-edit"><span class="glyphicon glyphicon-edit"></span> {{ document.dateEdited | dateCutoffFuture | amTimeAgo }}</div>
    }
    @if (gatheringDates.start) {
      <div class="observation-start"> <span class="glyphicon glyphicon-time"></span> {{ gatheringDates.start | amDateFormat:'DD.MM.YYYY' }} </div>
    }
    @if (gatheringDates.end && gatheringDates.end !== gatheringDates.start) {
      <div class="observation-end">- {{ gatheringDates.end | amDateFormat:'DD.MM.YYYY' }}</div>
    }
  </section>

  <section class="unit-list">
    @if (document.gatherings?.length ?? 0 > 1) {
      <div>({{ document.gatherings!.length - 1 }} {{ 'haseka.users.latest.other' | translate }})</div>
    }
    <div>
      @if (unitList && unitList.length < 1) {
        <div class="d-inline-block">
          <span>{{ unitList.length }} </span>
          <span>{{ 'haseka.users.latest.gathered' | translate }}</span>
        </div>
      }
      @if (unitList && unitList.length > 0) {
        <div class="link d-inline-block" (click)="showUnitList($event)">
          <span>{{ unitList.length }} </span>
          @if (unitList.length === 1) {
            <span>{{ 'haseka.users.latest.gathered.singular' | translate }} </span>
          }
          @if (unitList.length !== 1) {
            <span>{{ 'haseka.users.latest.gathered' | translate }} </span>
          }
          <span class="glyphicon"
            style="font-size:0.8em"
          [ngClass]="{ 'glyphicon-triangle-bottom': showList, 'glyphicon-triangle-right': !showList }"></span>
        </div>
      }
    </div>

    @if (showList) {
      <ul>
        @for (taxon of unitList | slice:0:5; track taxon) {
          <li>
            {{ taxon }}
          </li>
        }
        @if (unitList.length > 5) {
          <li>{{ unitList.length - 5 }} {{ 'haseka.users.latest.other' | translate }}</li>
        }
      </ul>
    }
  </section>

  <section class="d-flex flex-row flex-nowrap justify-end">
    <button class="btn btn-default btn-sm ml-2"
      (click)="onShowViewer($event)"
      role="button" tabindex="0" luKeyboardClickable>
      <span class="glyphicon glyphicon-eye-open"></span>
      {{ 'haseka.submissions.view' | translate }}
    </button>
    <a class="btn btn-default btn-sm ml-2"
      [routerLink]="editDocumentRoute"
      role="button" tabindex="0" luKeyboardClickable>
      <span class="glyphicon glyphicon-edit"></span>
      {{ 'haseka.submissions.edit' | translate }}
    </a>
  </section>

</div>
