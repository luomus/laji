<div>
  <h3>{{taxonSet}}</h3>
</div>

<div class="download-row">
  <laji-download
    [downloadLoading]="downloadLoading"
    [formats]="['csv', 'tsv', 'ods', 'xlsx']"
    (download)="download($event.fileType)"
    ><span><i class="glyphicon glyphicon-download-alt"></i> {{ 'wbc.stats.route.table.download' | translate }} </span>
  </laji-download>
</div>

<laji-datatable
  #dataTable
  [showHeader]="true"
  [showFooter]="false"
  [height]="'calc(80vh - 40px)'"
  [virtualScrolling]="true"
  [rows]="rows!"
  [loading]="loading"
  [columnMode]="'force'"
  [totalMessage]="'haseka.submissions.total' | translate"
  [emptyMessage]="'wbc.stats.noHits' | translate"
  [columns]="columns"
  [sorts]="sorts"
  [getRowClass]="_getRowClass"
  [showRowAsLink]="false"
  [clientSideSorting]="true"
  (sortChange)="onSort($event)">
</laji-datatable>

<ng-template let-value="value" let-row="row" #textOrTranslationKey>
  <ng-container>
    @if (value) {
      <span [title]="value">{{ value }}</span>
    }
  </ng-container>
  <ng-template #translationKey>
    @if (value) {
      <span [title]="value">
        {{ value}}
      </span>
    }
  </ng-template>
</ng-template>

<ng-template let-value="value" let-row="row" #numberOrDocumentIds>
  @if (row.name !== 'documentIds') {
    @if (value || value === 0) {
      <span [title]="roundNumber(value)">{{ roundNumber(value) }}</span>
    }
  } @else {
    @if (value && value.length > 0) {
      <span ngPreserveWhitespaces style="display: inline-block">
        @for (doc of value; track doc) {
          <a (click)="documentClick.emit(doc)" title="{{doc}}" class="link">{{ 'wbc.stats.route.table.link' | translate }}</a>
        }
      </span>
    }
  }
  <ng-template #documentIds>
    @if (value && value.length > 0) {
      <span ngPreserveWhitespaces style="display: inline-block">
        @for (doc of value; track doc) {
          <a (click)="documentClick.emit(doc)" title="{{doc}}" class="link">{{ 'wbc.stats.route.table.link' | translate }}</a>
        }
      </span>
    }
  </ng-template>
</ng-template>
