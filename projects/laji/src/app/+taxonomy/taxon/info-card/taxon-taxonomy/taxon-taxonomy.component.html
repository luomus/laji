<div class="row">
  <div class="col-xs-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <p>
          <span class="scientificName" [class.cursive]="taxon.cursiveName">{{ taxon.scientificName }}</span>
          @if (taxon.scientificNameAuthorship) {
            <span class="author">{{ taxon.scientificNameAuthorship }}</span>
          }
        </p>
        @if (!taxon.synonymOf) {
          <p class="green-text">{{ 'taxonomy.acceptedName' | translate }}, {{ taxon.nameAccordingTo | checklist }}</p>
        }
        @if (taxon.synonymOf) {
          <p>
            @if (synonymType) {
              <span class="red-text">{{ 'MX.has' + synonymType[0].toUpperCase() + synonymType.substring(1, synonymType.length - 1) | label | uppercase }} {{ 'taxonomy.ofTaxon' | translate }} </span>
            }
            <a [routerLink]="['/taxon', taxon.synonymOf.id, 'taxonomy'] | localize" [queryParams]="{context: null}" [queryParamsHandling]="'merge'" target="_blank">
              <laji-taxon-name [capitalizeName]="true" [taxon]="taxon.synonymOf" [addLink]="false"></laji-taxon-name>
            </a>
            @if (taxon.synonymOf.scientificNameAuthorship) {
              <span class="author">{{ taxon.synonymOf.scientificNameAuthorship }}</span>
            }
          </p>
        }
        @if (taxon.notes) {
          <label>{{ 'MX.notes' | label }}</label>
          <p>{{ taxon.notes }}</p>
        }
        @if (taxon.originalPublications) {
          <label>{{ 'taxonomy.originalPublications' | translate }}</label>
        }
        <ul>
          @for (publication of taxon.originalPublications; track publication) {
            <li>
              {{ publication | publication }}
              @if (publication | publication:'URI'; as link) {
                <br>
                  <a [href]="link" target="_blank">{{ 'taxonomy.link' | translate }}</a>
                }
              </li>
            }
          </ul>
        </div>
      </div>
      <!--<div *ngIf="taxon.synonymNames && taxon.synonymNames.length > 0"
      class="panel panel-default"
      laji-panel
      [title]="'taxonomy.synonyms' | translate"
      [open]="true"
      [autoToggle]="true"
      >
      <laji-taxon-synonyms [taxon]="taxon" [synonymTypes]="synonymTypes"></laji-taxon-synonyms>
    </div>-->
    @if (taxon.vernacularName || taxon.alternativeVernacularName || taxon.tradeName || taxonHasSynonymKey(taxon) || taxon.obsoleteVernacularName) {
      <div
        class="panel panel-default"
        laji-panel
        [title]="'taxonomy.otherNames' | translate"
        [open]="true"
        [autoToggle]="true"
        >
        <laji-taxon-names [taxon]="taxon"></laji-taxon-names>
      </div>
    }
    <div class="panel panel-default"
      laji-panel
      [title]="'taxonomy.taxonConcept' | translate"
      [open]="true"
      [autoToggle]="true"
      >
      <laji-taxon-concept-info
        [taxon]="taxon"
      ></laji-taxon-concept-info>
    </div>
    <laji-taxon-description
      [taxonDescriptions]="taxonDescription"
      [groupId]="'MX.SDVG14'"
      [title]="'taxonomy.taxonomy' | translate"
    ></laji-taxon-description>
    <div class="panel panel-default"
      laji-panel
      [title]="'taxonomy.bold' | translate"
      [open]="true"
      [autoToggle]="true">
      <laji-taxon-bold [taxon]="taxon"></laji-taxon-bold>
    </div>
    @if (taxon.taxonExpert) {
      <div class="panel panel-default"
        laji-panel
        [title]="'taxonomy.taxonExpert' | translate"
        [open]="true"
        [autoToggle]="true">
        @for (expert of taxon.taxonExpert; track expert) {
          <div>
            {{ expert | users }}
          </div>
        }
      </div>
    }
    @if (taxon.hasChildren) {
      <div
        class="panel panel-default"
        laji-panel
        [title]="'taxonomy.belongs.to' | translate"
        [open]="true"
        [autoToggle]="true"
        >
        <laji-datatable
          (rowSelect)="taxonSelect.emit($event.row.id)"
          [showFooter]="false"
          [virtualScrolling]="false"
          [clientSideSorting]="true"
          [rows]="taxonChildren"
          [count]="taxonChildren.length"
          [page]="1"
          [pageSize]="taxonChildren.length"
        [columns]="[
          {
            name: 'vernacularName',
            label: 'taxonomy.vernacular.name',
            sortable: true
          },
          {
            name: 'scientificName',
            label: 'taxonomy.scientific.name',
            cellTemplate: 'taxonScientificName',
            sortable: true
          },
          {
            name: 'finnish',
            label: 'taxonomy.finnish',
            cellTemplate: 'boolean',
            sortable: true
          },
          {
            name: 'observationCountFinland',
            label: 'taxonomy.finnishObservations',
            sortable: true
          }
        ]">
      </laji-datatable>
    </div>
  }
</div>
</div>
