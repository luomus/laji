@if (taxon.species) {
  @if (taxon.multimedia?.length! > 0) {
    @for (multimedia of taxon.multimedia; track multimedia; let i = $index) {
      <img lajiLazyImage (click)="openImage(i)" [src]="taxon.multimedia![i].largeURL">
      <ng-container *ngTemplateOutlet="imageCopyright; context:{ $implicit: taxon.multimedia![i] }"></ng-container>
    }
  } @else {
    <div class="no-image">
      <img class="no-image-icon" [src]="'static/images/icons/x-octagon.png'">
      <h4 class="no-image-title">
        {{ 'annotation.noImages' | translate }}
      </h4>
    </div>
  }
}

@if (taxon.children?.length === 0) {
  @if (taxon.multimedia?.length! > 0) {
    <img (click)="openImage()" [src]="taxon.multimedia![0].largeURL">
    <ng-container *ngTemplateOutlet="imageCopyright; context:{ $implicit: taxon.multimedia![0] }"></ng-container>
  } @else {
    <div class="no-image">
      <img class="no-image-icon" [src]="'static/images/icons/x-octagon.png'">
      <h4 class="no-image-title">
        {{ 'annotation.noImages' | translate }}
      </h4>
    </div>
  }
}

@if (taxon.children?.length! > 0) {
  <div class="species-container-container mb-8">
    <div class="species-navigation back" (mousedown)="discreteScroll(-1)">
      <div class="glyphicon glyphicon-chevron-left"></div>
    </div>
    <div class="species-navigation next" (mousedown)="discreteScroll(1)">
      <div class="glyphicon glyphicon-chevron-right"></div>
    </div>
    <div class="d-flex species-container" #speciesContainer>
      @for (child of taxon.children; track child; let i = $index) {
        <div class="species d-flex flex-col mr-4">
          <h5>
            <a [routerLink]="['/taxon', child.id, 'identification'] | localize" queryParamsHandling="preserve">
              <laji-taxon-name [capitalizeName]="true" [addLink]="false" [taxon]="child"></laji-taxon-name>
            </a>
          </h5>
          @if (child.multimedia?.length! > 0) {
            <div class="species-img-container">
              <img (click)="openImage(i)" [src]="child.multimedia![0].largeURL">
            </div>
          } @else {
            <div class="species-no-img-container">
              <ng-container *ngTemplateOutlet="noImage"></ng-container>
            </div>
          }
        </div>
      }
    </div>
  </div>
}


<ng-template #noImage>
  <div class="no-image">
    <img class="no-image-icon" [src]="'static/images/icons/x-octagon.png'">
    <h4 class="no-image-title">
      {{ 'annotation.noImages' | translate }}
    </h4>
  </div>
</ng-template>

<ng-template #imageCopyright let-multimedia>
  @if (multimedia) {
    <div class="image-copyright">
      @if (multimedia.copyrightOwner) {
        <div>
          <b>{{ 'taxonomy.multimedia.copyrightOwner' | translate }}:</b>
          {{ multimedia.copyrightOwner }}
        </div>
      }
      @if (multimedia.licenseAbbreviation) {
        <div>
          <b>{{ 'taxonomy.multimedia.licenseAbbreviation' | translate }}:</b>
          {{ multimedia.licenseAbbreviation }}
        </div>
      }
      @if (multimedia.taxonDescriptionCaption) {
        <div>
          <b>{{ 'taxonomy.multimedia.taxonDescriptionCaption' | translate }}:</b>
          {{ multimedia.taxonDescriptionCaption | multiLang }}
        </div>
      }
      @if (multimedia.licenseId) {
        <laji-license type={{multimedia.licenseId}}></laji-license>
      }
    </div>
  }
</ng-template>
