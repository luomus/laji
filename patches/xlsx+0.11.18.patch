patch-package
--- a/node_modules/xlsx/xlsx.js
+++ b/node_modules/xlsx/xlsx.js
@@ -8,7 +8,10 @@ XLSX.version = '0.11.18';
 var current_codepage = 1200, current_ansi = 1252;
 /*global cptable:true */
 if(typeof module !== "undefined" && typeof require !== 'undefined') {
-	if(typeof cptable === 'undefined') global.cptable = require('./dist/cpexcel.js');
+  if(typeof cptable === 'undefined') {
+    if(typeof global !== 'undefined') global.cptable = require('./dist/cpexcel.js');
+    else if(typeof window !== 'undefined') window.cptable = require('./dist/cpexcel.js');
+  }
 }
 
 var VALID_ANSI = [ 874, 932, 936, 949, 950 ];
@@ -12056,6 +12059,19 @@ var WS_XML_ROOT = writextag('worksheet', null, {
 	'xmlns:r': XMLNS.r
 });
 
+function write_ws_xml_datavalidation(validations) {
+  var o = '<dataValidations count="' + validations.length + '">';
+  for(var i=0; i < validations.length; i++) {
+    var validation = validations[i];
+    o += '<dataValidation type="list" operator="equal" allowBlank="1" showInputMessage="1" sqref="' + validation.sqref + '">';
+    o += '<formula1>' + validation.sqtarget + '</formula1>';
+    o += '</dataValidation>';
+  }
+  o += '</dataValidations>';
+
+  return o;
+}
+
 function write_ws_xml(idx, opts, wb, rels) {
 	var o = [XML_HEADER, WS_XML_ROOT];
 	var s = wb.SheetNames[idx], sidx = 0, rdata = "";
@@ -12105,6 +12121,7 @@ function write_ws_xml(idx, opts, wb, rels) {
 	/* customSheetViews */
 
 	if(ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));
+  if(ws['!dataValidation']) o[o.length] = write_ws_xml_datavalidation(ws['!dataValidation']);
 
 	/* phoneticPr */
 	/* conditionalFormatting */
