<tabset>
  <tab [heading]="'search.result.map' | translate"
       (select)="activate('map')"
       [active]="active === 'map'">
    <div>
      <laji-observation-map
        *ngIf="active === 'map'"
        [color]="'#AA00BB'"
        [opacity]="0.2"
        [visible]="active === 'map'"
        [height]="800"
        [query]="searchQuery.query"
        (select)="pickLocation($event)"
      ></laji-observation-map>
    </div>
  </tab>
  <tab [heading]="'search.result.list' | translate"
       (select)="activate('list')"
       [active]="active === 'list'">
    <laji-observation-result-list *ngIf="activated['list']"></laji-observation-result-list>
  </tab>
  <tab [heading]="'search.result.species' | translate"
       (select)="activate('species')"
       [active]="active === 'species'">
    <laji-observation-aggregate
      [field]="'unit.linkings.taxon.scientificName,unit.linkings.taxon.nameEnglish,unit.linkings.taxon.nameFinnish,unit.linkings.taxon.nameSwedish,unit.linkings.taxon.id'"
      [title]="'taxon'"
      [valuePicker]="pickValue"
      [linkPicker]="pickLink"
      [queryOverride]="{includeNonValidTaxa: false, taxonRankId: 'MX.species'}"
      [limit]="50"
      [showPager]="true"></laji-observation-aggregate>
  </tab>
  <tab [heading]="'search.result.stats' | translate"
       (select)="activate('stats')"
       [active]="active === 'stats'">
    <div class="form-group" *ngIf="activated['stats']">
      <div class="col-md-6">
        <laji-observation-chart
          [height]="300"
          [showLegend]="true"
          [active]="active === 'stats'"
        ></laji-observation-chart>
      </div>
      <div class="col-md-6">
        <laji-observation-aggregate
          [field]="'unit.recordBasis'"
          [title]="'Tietue tyyppi'"></laji-observation-aggregate>
      </div>
    </div>
  </tab>
  <tab
    [heading]="'search.result.load' | translate"
    (select)="activate('load')"
    [active]="active === 'load'">
    <div class="form-group">
      <div class="col-sm-12">
        <div *ngIf="userService.isLoggedIn()">
          <strong>Karkeistettuja</strong>
          <laji-observation-count
            [query]="searchQuery.query"
            [field]="'document.secureLevel'"
            [pick]="['HIGHEST','KM100','KM50','KM25', 'KM10']"
          >
          </laji-observation-count><br>
          <div class="row">
            <div class="col-sm-6">
              <p>
                {{'result.load.introPublic' | translate}}
              </p>
              <div *ngIf="!requests['public']">
                <button class="btn btn-default" (click)="makePublicRequest()">lataa aineisto</button>
              </div>
              <div *ngIf="requests['public']">
                {{'result.load.thanksPublic' | translate}}
              </div>
            </div>
            <div class="col-sm-6">
              <p>
                {{'result.load.introPrivate' | translate}}
              </p>
              <div *ngIf="!requests['downloadApprovalRequest']">
                <button class="btn btn-default" (click)="makePrivateRequest()">tee pyyntö</button>
              </div>
              <div *ngIf="requests['downloadApprovalRequest']">
                {{'result.load.thanksRequest' | translate}}
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="!userService.isLoggedIn()">
          {{'force.login' | translate}}
        </div>
      </div>
    </div>
  </tab>
</tabset>
