<div class="row" id="letterInfo">
  <div class="col-md-12">
    <h2>
      <laji-taxon-name [taxon]="taxon$ | async" [capitalizeName]="true"></laji-taxon-name>
      <laji-info [html]="'theme.kerttu.info.taxon' | translate"></laji-info>
    </h2>
    <dl>
      <dt>{{ 'theme.kerttu.letter' | translate }}:</dt>
      <dd>{{ template?.name }}</dd>
      <dt>{{ 'theme.kerttu.annotationsDone' | translate }}:</dt>
      <dd>{{ statusInfo?.userAnnotationCount }}/{{ statusInfo?.targetAnnotationCount }}</dd>
    </dl>
    <div>
      <lu-button [disabled]="!candidate || !statusInfo?.hasPreviousCandidate" (click)="backToPreviousCandidateClick.emit()">
        Palaa edelliseen ehdokkaaseen
      </lu-button>
      <laji-info [html]="'theme.kerttu.info.goBackToPreviousCandidate' | translate"></laji-info>
    </div>
    <div>
      <lu-button [disabled]="!template" (click)="onSkipLetter()">
        {{ 'theme.kerttu.skipLetter' | translate }}
      </lu-button>
      <laji-info [html]="'theme.kerttu.info.skipLetter' | translate"></laji-info>
    </div>
  </div>
</div>
<div id="letterAnnotationContainer" class="row">
  <div class="col-md-12">
    <h3>
      {{ 'theme.kerttu.areLettersSame' | translate }}
      <laji-info [html]="'theme.kerttu.info.areLettersSame' | translate"></laji-info>
    </h3>
    <div id="letterAnnotationButtons">
      <ng-container *ngFor="let a of [annotation.yes, annotation.no, annotation.unsure]">
        <lu-button [disabled]="!template || !candidate || loadingTemplate || loadingCandidate" (click)="onAnnotationChange(a)">
          {{ a === annotation.yes ? ('yes' | translate) : a === annotation.no ? ('no' | translate) : ('theme.kerttu.notSure' | translate) }}
        </lu-button>
      </ng-container>
    </div>
  </div>
  <div class="col-md-12" id="letterAnnotationControls">
    <div>
      <label>{{ 'theme.kerttu.timeBuffer' | translate }}</label>
      <laji-info [html]="'theme.kerttu.info.timeBuffer' | translate"></laji-info>
      <div class="input-group" style="max-width: 110px">
        <select
          class="form-control input-sm"
          [ngModel]="xRangePadding"
          (ngModelChange)="onXRangePaddingChange($event)"
        >
          <option *ngFor="let value of [0.5, 1, 5, 10, 30]" value="{{ value }}">{{ value }}</option>
        </select>
        <span class="input-group-addon">s</span>
      </div>
    </div>
    <div>
      <label>{{ 'theme.kerttu.targetFrequency' | translate }}</label>
      <laji-info [html]="'theme.kerttu.info.targetFrequency' | translate"></laji-info>
      <bSwitch
        [switch-on-text]="'yes' | translate"
        [switch-off-text]="'no' | translate"
        [switch-on-color]="'primary'"
        [switch-size]="'small'"
        [(ngModel)]="zoomed"
        [switch-base-class]="'bootstrap-switch'">
      </bSwitch>
    </div>
    <div style="vertical-align: bottom">
      <lu-button [small]="true" (click)="setDefaultSettings()">Palauta oletusasetukset</lu-button>
      <laji-info [html]="'theme.kerttu.info.setDefaultSettings' | translate"></laji-info>
    </div>
  </div>
  <div class="col-md-6 col-md-push-6">
    <h4>{{ 'theme.kerttu.letterTemplate' | translate }}</h4>
    <laji-audio-viewer
      [recording]="template?.recording"
      [xRangePadding]="xRangePadding"
      [xRange]="template?.xRange"
      [yRange]="template?.yRange"
      [zoomed]="zoomed"
      (audioLoading)="loadingTemplate = $event"
    ></laji-audio-viewer>
  </div>
  <div class="col-md-6 col-md-pull-6">
    <h4>{{ 'theme.kerttu.letterCandidate' | translate }} ({{ 'theme.kerttu.correlation' | translate }} {{ candidate?.crossCorrelation | number : '1.0-2' }})</h4>
    <laji-audio-viewer
      [recording]="candidate?.recording"
      [xRangePadding]="xRangePadding"
      [xRange]="candidate?.xRange"
      [yRange]="candidateYRange"
      [zoomed]="zoomed"
      [autoplay]="autoplayCandidate"
      [autoplayRepeat]="3"
      (audioLoading)="loadingCandidate = $event"
    ></laji-audio-viewer>
  </div>
  <div class="col-md-12">
    <h4>
      {{ 'theme.kerttu.letterCandidateLonger' | translate }}
      <laji-info [html]="'theme.kerttu.info.letterCandidateLonger' | translate"></laji-info>
    </h4>
    <lu-button (click)="candidateLongerVisible = true" *ngIf="!candidateLongerVisible">
      Näytä
    </lu-button>
    <laji-audio-viewer
      *ngIf="candidateLongerVisible"
      [recording]="candidate?.recording"
      [xRange]="candidate?.xRange"
      [yRange]="candidateYRange"
      [zoomed]="zoomed"
    ></laji-audio-viewer>
  </div>
</div>
