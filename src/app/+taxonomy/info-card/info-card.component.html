<div class="container" *ngIf="taxon">
  <h1><i>{{taxon.scientificName}}</i>
    <small *ngIf="taxon.vernacularName">{{taxon.vernacularName | multiLang}}</small>
  </h1>
  <laji-parents [includeCurrent]="false" [current]="taxon"></laji-parents>
  <div class="row">
    <div class="col-sm-6" *ngIf="taxonDescription && taxonDescription.length > 0">
      <select style="margin-bottom: 8px;" class="form-control" [(ngModel)]="activeDescription">
        <option *ngFor="let description of taxonDescription; let i = index" [value]="i">{{ description.title ? description.title[translate.currentLang] ? description.title[translate.currentLang] : description.id : description.id }}</option>
      </select>
      <div class="panel-group" role="tablist" aria-multiselectable="true">
        <div class="panel panel-default" *ngFor="let group of taxonDescription[activeDescription].groups; let i = index"
             [title]="group.title[translate.currentLang]" [open]="activePanel == i"
             [index]="i" (activate)="setActive($event)" laji-panel>
          <div *ngFor="let variable of group.variables">
            <h4 *ngIf="variable.title.fi.toLowerCase().localeCompare('ingressi', { sensitivity: 'accent' }) != 0">{{ variable.title[translate.currentLang] }}</h4>
            <span [innerHTML]="variable.content[translate.currentLang]"></span>
          </div>
        </div>
      </div>
    </div>
    <div [class.col-sm-6]="taxonDescription && taxonDescription.length > 0">
      <div [class.col-sm-3]="taxonDescription && taxonDescription.length < 1">
        <div class="panel panel-default">
          <div class="panel-heading" role="tab">
            <h4 class="panel-title">{{ 'taxonomy.images' | translate }}</h4>
          </div>
          <div class="panel-body">
            <ImageModal [modalImages]="taxonImages"></ImageModal>
          </div>
        </div>
      </div>
      <div [class.col-sm-5]="taxonDescription && taxonDescription.length < 1">
        <div class="panel panel-default">
          <div class="panel-heading" role="tab">
            <h4 class="panel-title">{{ 'taxonomy.card' | translate }}</h4>
          </div>
          <div class="panel-body">
            <laji-taxon-info [taxon]="taxon"></laji-taxon-info>
          </div>
        </div>
      </div>
      <div [class.col-sm-4]="taxonDescription && taxonDescription.length < 1">
        <div class="panel panel-default">
          <div class="panel-heading" role="tab">
            <h4 class="panel-title">{{ 'taxonomy.map' | translate }}</h4>
          </div>
          <div class="panel-body">
            <laji-observation-map [color]="'#009900'" [query]="{taxonId: [taxon.id], counteryId: ['ML.206']}"
                                  [height]="300" [draw]="false">
            </laji-observation-map>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="taxon.hasChildren" class="row">
    <div class="col-xs-12">
      <h3>{{ 'taxonomy.group' | translate }} <b>{{ taxon.vernacularName | multiLang }}</b> {{ 'taxonomy.belongs.to' | translate }}</h3>
      <laji-children-list [parentId]="taxon.id"></laji-children-list>
    </div>
  </div>
</div>
