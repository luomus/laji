<laji-spinner [spinning]="loading" [overlay]="true">
  <ngx-datatable
    #dataTable
    class='material striped laji-datatable'
    [style.height]="height"
    [cssClasses]="{
          sortAscending: 'glyphicon glyphicon-chevron-down',
          sortDescending: 'glyphicon glyphicon-chevron-up',
          pagerLeftArrow: 'glyphicon glyphicon-chevron-left',
          pagerRightArrow: 'glyphicon glyphicon-chevron-right',
          pagerPrevious: 'glyphicon glyphicon-step-backward',
          pagerNext: 'glyphicon glyphicon-step-forward'
        }"
    [messages]="{
          emptyMessage: '',
          totalMessage: ''
        }"
    [rows]='rows'
    [disablePagingOnScroll]="true"
    [externalPaging]="true"
    [externalSorting]="true"
    [preFetchY]="300"
    [sortType]="'multi'"
    [count]="count"
    [offset]="_offset"
    [limit]="pageSize"
    [columns]="_columns"
    [columnMode]="'force'"
    [scrollbarH]="true"
    [scrollbarV]="virtualScrolling"
    [headerHeight]="showHeader ? 38 : 0"
    [footerHeight]="showFooter ? 50 : 0"
    [trackByProp]="'name'"
    [rowHeight]="35"
    (sort)="sortChange.emit($event)"
    (page)="onPage($event)"
    (activate)="onRowSelect($event)"
  >
  </ngx-datatable>
</laji-spinner>

<ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template #headerTpl>
  <span class="datatable-header-cell-wrapper sort-full-width"
        (click)="sort()"
        title="{{column.name}}">
    <span class="datatable-header-cell-label draggable">
      <span title="{{column.label | translate}}">{{column.label | translate}}</span>
    </span>
  </span>
</ng-template>

<ng-template let-value="value" #warehouseLabel>
  <span *ngIf="value" title="{{value | label: 'warehouse'}}">
    {{value | label: 'warehouse'}}
  </span>
</ng-template>
<ng-template let-value="value" #toSemicolon>
  <span *ngIf="value" title="{{value.join('; ')}}">
    {{value.join('; ')}}
  </span>
</ng-template>
<ng-template let-value="value" #numeric>
  <span *ngIf="value" title="{{value | formattedNumber:' '}}">
    <span [innerHtml]="value | formattedNumber:'&nbsp;'"></span>
  </span>
</ng-template>
<ng-template let-value="value" #vernacularName>
  <span *ngIf="value.vernacularName" title="{{value.vernacularName | multiLang}}">
    {{value.vernacularName | multiLang}}
  </span>
</ng-template>
<ng-template let-value="value" #scientificName>
  <span *ngIf="value.scientificName" title="{{value.scientificName}}" [class.cursive]="value.cursiveName">
    {{value.scientificName}}
  </span>
</ng-template>
<ng-template let-value="value" #speciesScientificName>
  <span *ngIf="value.speciesScientificName" title="{{value.speciesScientificName}}" [class.cursive]="value.cursiveName">
    {{value.speciesScientificName}}
  </span>
</ng-template>
<ng-template let-value="value" #speciesVernacularName>
  <span *ngIf="value.speciesVernacularName" title="{{value.speciesVernacularName | multiLang}}">
    {{value.speciesVernacularName | multiLang}}
  </span>
</ng-template>
<ng-template let-value="value" ngx-datatable-cell-template #eventDate>
  <span *ngIf="value && value.end && value.begin">
    <span *ngIf="value.begin === value.end; else dateRange" title="{{value.begin}}">{{value.begin}}</span>
    <ng-template #dateRange><span title="{{value.begin}} - {{value.end}}">{{value.begin}} - {{value.end}}</span></ng-template>
  </span>
</ng-template>
