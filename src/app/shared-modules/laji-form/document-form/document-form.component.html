<ng-container *ngIf="vm$ | async; let vm">
  <laji-spinner [spinning]="vm.loading" [overlay]="true"></laji-spinner>
  <div style="margin-top: 20px;">
    <div [hidden]="!hasAlertContent">
      <laji-info-page child="2860" (hasContent)="hasAlertContent = $event"></laji-info-page>
    </div>
    <ng-container [ngSwitch]="vm.error">
      <alert type="danger" *ngSwitchCase="errors.notFoundForm">
        {{ 'haseka.form.formNotFound' | translate:{formId: this.formId} }}
      </alert>
      <alert type="danger" *ngSwitchCase="errors.notFoundDocument">
        {{ 'haseka.form.documentNotFound' | translate:{documentId: this.documentId} }}
      </alert>
      <alert type="danger" *ngSwitchCase="errors.loadFailed">
        {{ 'haseka.form.genericError' | translate }}
      </alert>
      <alert type="danger" *ngSwitchCase="errors.noAccessToDocument">
        {{ 'haseka.form.noAccessToDocument' | translate }}
      </alert>
    </ng-container>
  </div>
  <laji-document-form-header *ngIf="showHeader && vm.error === errors.ok"
      [formID]="vm.form.id"
      [edit]="!!documentId"
      [namedPlace]="vm.namedPlace"
      [isAdmin]="isAdmin"
      [formData]="vm.form.formData"
      [displayObservationList]="!vm.form.formData?.id && vm.namedPlace?.namedPlace && vm.form.options?.displayOwnSubmissions"
  ></laji-document-form-header>
    <div class="clear"></div>
    <div class="laji-form" *ngIf="vm.error === errors.ok">
      <laji-form
        [formData]="vm.form"
        [settingsKey]="formId"
        [showShortcutButton]="showShortcutButton"
        (dataChange)="onChange($event)"
        (dataSubmit)="onSubmit($event)"
        (validationError)="onValidationError($event)"
      ></laji-form>
      <div class="" *ngIf="template">
        <div class="modal-body">
          <label for="templateName">{{ 'template.name' | translate }}: <span class="required">*</span></label>
          <input id="templateName" class="form-control" type="text" [(ngModel)]="templateForm.name" name="name">
          <label for="templateDescription">{{ 'template.description' | translate }}:</label>
          <textarea id="templateDescription" class="form-control" [(ngModel)]="templateForm.description" name="description"></textarea>
          <span class="required">*</span> = {{ 'required' | translate }}
        </div>
      </div>
      <laji-document-form-footer
        [form]="vm.form"
        [status]="status"
        [readonly]="vm.form.readonly"
        [edit]="documentId"
        [errors]="validationErrors"
        [touchedCounter]="touchedCounter"
        [lajiForm]="lajiForm"
        [template]="template"
        (lock)="lock($event)"
        (submitPublic)="submitPublic()"
        (submitPrivate)="submitPrivate()"
        (submitTemplate)="submitTemplate()"
        (cancel)="onCancel()"></laji-document-form-footer>
    </div>
</ng-container>
