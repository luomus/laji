<div class="container container-relative">
  <h1>{{'navigation.user.profile' | translate}}</h1>
  <laji-spinner [spinning]="loading" [hideContentWhileLoading]="true">
    <div class="row" *ngIf="!profile.profileKey">
      {{'profile.missing'|translate}}
    </div>
    <div class="row" *ngIf="profile.profileKey || isCurrentUser">
      <div class="col-md-8 col-xs-12">
        <h3>{{profile.userID | users}}</h3>
        <div class="profile-image">
          <img *ngIf="profile.image" [src]="profile.image" alt="profile image" class="img-rounded">
        </div>
        <div *ngIf="isCurrentUser"
             class="btn-default btn btn-sm edit-text"
             (click)="toggleEditing()"><i class="glyphicon glyphicon-cog"></i>
        </div>
        <div *ngIf="!editing">
          <p>{{profile.profileDescription}}</p>
        </div>
        <div *ngIf="editing" class="profile-edit">
          <div class="profile-edit-row">
            {{'profile.image' | translate}}
            <input class="form-control" placeholder="Image url" [(ngModel)]="profile.image">
          </div>
          <div class="profile-edit-row">
            {{'profile.description' | translate}}
            <textarea class="form-control" [(ngModel)]="profile.profileDescription"></textarea>
          </div>
          <div class="profile-edit-row">
            <div class="btn btn-default" (click)="saveProfile()">{{'profile.save' | translate}}</div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-xs-12">
        <div class="form-group">
          <div class="col-sm-12 well">
            <laji-find-person (select)="selectPerson($event)"></laji-find-person>
            <friends [profile]="profile" [usersProfile]="personsProfile"></friends>
          </div>
        </div>
        <div class="form-group" *ngIf="(getCurrentUser() | async).id === userId">
          <div class="col-sm-12 well">
            <a [href]="personSelfUrl | safe:'url'" class="btn btn-success">{{'profile.accountSettings'|translate}}</a>
          </div>
        </div>
      </div>
    </div>
  </laji-spinner>
</div>

