<hr>
<div class="unit" *ngIf="unit">
  <div [ngClass]="{'highlight': highlight === unit.unitId}">
    <laji-row *ngIf="unit.linkings && unit.linkings.originalTaxon; else taxonVerbatim" [title]="unit.recordBasis | label: 'warehouse'">
      <span class="vernacularName" *ngIf="unit.linkings.originalTaxon.vernacularName">
        {{unit.linkings.originalTaxon.vernacularName | multiLang}}
      </span>
      <span class="scientificName">
        (<span [class.cursive]="unit.linkings.originalTaxon.cursiveName">{{unit.linkings.originalTaxon.scientificName}}</span>)
        <a [routerLink]="['/taxon/' + unit.linkings.originalTaxonId] | localize" target="_blank"><i class="glyphicon glyphicon-modal-window"></i></a>
      </span>
    </laji-row>
    <ng-template #taxonVerbatim>
      <laji-row [title]="unit.recordBasis | label: 'warehouse'" [value]="unit.originalTaxonVerbatim"></laji-row>
    </ng-template>
    <div *ngIf="showFacts && unit.quality && unit.quality.taxon && unit.quality.taxon.reliability">
      <laji-row [title]="'result.unit.quality.taxon'|translate">
        {{unit.quality.taxon.reliability | label: 'warehouse'}}
        <span *ngIf="unit.quality.taxon.source">
          ({{unit.quality.taxon.source | label: 'warehouse'}})
        </span>
      </laji-row>
    </div>
    <laji-row
      *ngIf="unit.linkings && unit.linkings.taxon && unit.linkings.originalTaxon && unit.linkings.taxon.qname !== unit.linkings.originalTaxon.qname"
      [title]="'MAN.opinion' | label">
      <span class="vernacularName" *ngIf="unit.linkings.taxon.vernacularName">
        {{unit.linkings.taxon.vernacularName | multiLang}}
      </span>
      <span class="scientificName">
        (<span [class.cursive]="unit.linkings.taxon.cursiveName">{{unit.linkings.taxon.scientificName}}</span>)
      </span>
    </laji-row>
    <laji-issues [data]="unit"></laji-issues>
    <laji-row [title]="'MY.count' | label" [value]="unit.abundanceString"></laji-row>
    <laji-row [title]="'MY.lifeStage' | label" [value]="unit.lifeStage | label: 'warehouse'"></laji-row>
    <laji-row [title]="'MY.sex' | label" [value]="unit.sex | label: 'warehouse'"></laji-row>
    <laji-row [title]="'MY.notes' | label" [value]="unit.notes"></laji-row>
    <div class="facts" *ngIf="showFacts && unit.facts">
      <laji-row [title]="item.fact | label:'fullUri'" [value]="item.value | label:'fullUri'" *ngFor="let item of unit.facts"></laji-row>
    </div>

    <div class="row">
      <div class="col-xs-12 col-md-8 col-md-offset-4">
        <div class="image-holder">
          <laji-image-gallery *ngIf="unit.media" [modalImages]="unit.media"></laji-image-gallery>
        </div>
      </div>
    </div>
  </div>
  <div class="annotation-btn">
    <button type="button"
            [tooltip]="'annotation.title' | translate"
            class="btn btn-xs {{annotationClass$ | async}}"
            (click)="toggleAnnotations()">
      <i class="fa {{annotationIcon}}"></i>
    </button>
  </div>
  <div *ngIf="annotationVisible">
    <div class="row">
      <div class="col-xs-12 col-md-10 col-md-offset-2">
        <laji-annotations
          [editors]="editors"
          [personID]="personID"
          [rootID]="documentID"
          [targetID]="unitID"
          [annotations]="annotations"
          (close)="hideAnnotations()"
          (onChange)="initAnnotationStatus()"
        ></laji-annotations>
      </div>
    </div>
  </div>
</div>
